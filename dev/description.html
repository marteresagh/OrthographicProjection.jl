<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Description · OrthographicProjection.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="OrthographicProjection.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">OrthographicProjection.jl</span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li class="is-active"><a class="tocitem" href="description.html">Description</a><ul class="internal"><li><a class="tocitem" href="#Input-Point-Cloud"><span>Input Point Cloud</span></a></li><li><a class="tocitem" href="#Core-Function:-Trie-Traversal"><span>Core Function: Trie Traversal</span></a></li><li><a class="tocitem" href="#Process:-segment-and-orthophoto"><span>Process: segment and orthophoto</span></a></li></ul></li><li><a class="tocitem" href="results.html">Results</a></li><li><a class="tocitem" href="script.html">Script</a></li><li><a class="tocitem" href="refs.html">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="description.html">Description</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="description.html">Description</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/marteresagh/OrthographicProjection.jl/blob/master/docs/src/description.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Description"><a class="docs-heading-anchor" href="#Description">Description</a><a id="Description-1"></a><a class="docs-heading-anchor-permalink" href="#Description" title="Permalink"></a></h1><p>In this package you can find two main algorithms:</p><ul><li><em>segment</em> : allows you to clip the points of a 3D point cloud contained in a volume,</li><li><em>orthophoto</em> : generates the image as orthographic projection of 3D point cloud (whole or clipped in a volume) with respect to a chosen plane</li></ul><p>Both of them has the same <strong>core function</strong>, that takes as input a <a href="https://github.com/potree/potree">point cloud Potree project</a> and a <a href="https://github.com/cvdlab/LinearAlgebraicRepresentation.jl">cuboidal LAR model</a>.</p><h2 id="Input-Point-Cloud"><a class="docs-heading-anchor" href="#Input-Point-Cloud">Input Point Cloud</a><a id="Input-Point-Cloud-1"></a><a class="docs-heading-anchor-permalink" href="#Input-Point-Cloud" title="Permalink"></a></h2><p>To manage a point cloud with huge number of points we use Potree project, achieved with the tool <a href="https://github.com/potree/PotreeConverter/tree/master">PotreeConverter 1.7</a>.</p><h3 id="Potree"><a class="docs-heading-anchor" href="#Potree">Potree</a><a id="Potree-1"></a><a class="docs-heading-anchor-permalink" href="#Potree" title="Permalink"></a></h3><p>A Potree is a data structure, used to store huge point clouds, based on octree. All details of this structure are described by Markus Schütz in his <a href="https://www.cg.tuwien.ac.at/research/publications/2016/SCHUETZ-2016-POT/SCHUETZ-2016-POT-thesis.pdf">thesis</a>.</p><p><img src="images/Octree.jpg" alt="potree"/></p><p>A Potree project is a collection of files, for each node of the octree there is a file called r, followed by a numeric code indicating its position in the hierarchy, for example:</p><ul><li><strong>r</strong> is the root node,</li><li><strong>r0</strong> is the first child of the root node,</li><li><strong>r07</strong> is the eighth child of the first child of the root node.</li></ul><p>Due to particular way of tagging nodes, it is possible store Potree in a trie data structure, provided by Julia in module <code>DataStructures.jl</code>. As the usual tree data structure, a trie is made up of collections of trie node. Every trie node has three components:</p><ul><li>a value, where store information: in our case the path to the (LAS or LAZ) file associated;</li><li>a map, where key is a digit and the value is trie node, used to establish the parent-child relationship;</li><li>boolean value, indicating the end of word. In our case <code>true</code> in each node.</li></ul><h2 id="Core-Function:-Trie-Traversal"><a class="docs-heading-anchor" href="#Core-Function:-Trie-Traversal">Core Function: Trie Traversal</a><a id="Core-Function:-Trie-Traversal-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Function:-Trie-Traversal" title="Permalink"></a></h2><p>To speed up the search for points falling within the region of interest we use trie to process the whole point cloud. Each node of Potree is generated by the decomposition of space into congruent regions: the volume occupied by the octree node is described as an <strong>AABB</strong>, which we find in the header of the file associated with the node. Assuming this, we only process nodes that intersect the volume. There are three possible options of intersection, see figure below:</p><ul><li><code>0</code> -&gt; volume not intersect octree node (skip this node and all subtree)</li><li><code>1</code> -&gt; volume intersect, but not contains, octree node (check for this node and his children)</li><li><code>2</code> -&gt; volume contains octree node (process this node and all subtree)</li></ul><p><img src="images/DFS.png" alt="example"/></p><p>In figure:</p><p>pink volume represents region of interest, points in yellow quads (<code>0</code>) are not processed, in green quads (<code>1</code>) only the points falling in pink volume are processed, and, without further checks, all points in blue quads (<code>2</code>) are processed.</p><h4 id="Pseudocode"><a class="docs-heading-anchor" href="#Pseudocode">Pseudocode</a><a id="Pseudocode-1"></a><a class="docs-heading-anchor-permalink" href="#Pseudocode" title="Permalink"></a></h4><pre><code class="language-julia">
function trie_traversal(trie::Trie, volume::Model):
  AABB = boundingbox(trie)

	intersection = modelsdetection(volume, AABB)
  if intersection == 2
    for k in keys(trie)
      file = trie[k]
      process(file)
    end
  elseif intersection == 1
    dfs(trie, volume)
  end
end

function dfs(trie::Trie, volume::Model):

	file = trie.value
	octree = octree2aabb(file)
	intersection = modelsdetection(volume, octree)

	if intersection == 1
		processif(file)

		for key in collect(keys(trie.children))
			dfs(trie.children[key], volume)
		end

	elseif intersection == 2

		for k in keys(trie)
			file = trie[k]
			process(file)
		end

	end
end</code></pre><h2 id="Process:-segment-and-orthophoto"><a class="docs-heading-anchor" href="#Process:-segment-and-orthophoto">Process: segment and orthophoto</a><a id="Process:-segment-and-orthophoto-1"></a><a class="docs-heading-anchor-permalink" href="#Process:-segment-and-orthophoto" title="Permalink"></a></h2><h4 id="Segment"><a class="docs-heading-anchor" href="#Segment">Segment</a><a id="Segment-1"></a><a class="docs-heading-anchor-permalink" href="#Segment" title="Permalink"></a></h4><p>All points of input point clouds within region of interest are simply stored and saved in a new LAS file.</p><h4 id="Orthophoto"><a class="docs-heading-anchor" href="#Orthophoto">Orthophoto</a><a id="Orthophoto-1"></a><a class="docs-heading-anchor-permalink" href="#Orthophoto" title="Permalink"></a></h4><p>Orthographic view projects at a right angle to the data plane.</p><p>An image is just a multidimensional array: a grid (with 3 channels for storing RGB color attribute) is inscribed into the projection of volume.</p><p>The first point that falls into a cell will be accepted and its quote (distance to plane) is stored in a buffer. If a point falls inside a cell that is already occupied then the point with the highest quote is accepted, because it is the closest point to the observer. <img src="images/raster.png" alt="orthographic projection"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">« Home</a><a class="docs-footer-nextpage" href="results.html">Results »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 30 March 2021 12:13">Tuesday 30 March 2021</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
